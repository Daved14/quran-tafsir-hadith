<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Ø¨ÙˆØµÙ„Ø© Ø§Ù„Ù‚Ø¨Ù„Ø©</title>
    
    <!-- ===== PWA Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª ===== -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#d4af37">
    
    <!-- ===== iOS Safari Ø§Ù„Ù…ÙØ­Ø³ÙÙ‘Ù† ===== -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…">
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- ===== Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª iOS ===== -->
    <link rel="apple-touch-icon" href="icons/icon-180x180.png">
    <link rel="apple-touch-icon" sizes="152x152" href="icons/icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="icons/icon-180x180.png">
    <link rel="apple-touch-icon" sizes="167x167" href="icons/icon-167x167.png">
    
    <!-- ===== Splash Screens Ù„Ù€ iOS ===== -->
    <!-- iPhone X / XS / 11 Pro -->
    <link rel="apple-touch-startup-image" 
          href="splash/splash-1125x2436.png"
          media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3)">
    
    <!-- iPhone XR / 11 -->
    <link rel="apple-touch-startup-image" 
          href="splash/splash-828x1792.png"
          media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2)">
    
    <!-- iPhone 12/13/14 -->
    <link rel="apple-touch-startup-image" 
          href="splash/splash-1170x2532.png"
          media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3)">
    
    <!-- iPhone 12/13/14 Pro Max -->
    <link rel="apple-touch-startup-image" 
          href="splash/splash-1284x2778.png"
          media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3)">
    
    <!-- iPhone 14 Pro -->
    <link rel="apple-touch-startup-image" 
          href="splash/splash-1179x2556.png"
          media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3)">
    
    <!-- iPhone 14 Pro Max -->
    <link rel="apple-touch-startup-image" 
          href="splash/splash-1290x2796.png"
          media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3)">
    
    <!-- ===== Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ===== -->
    <meta name="application-name" content="Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…">
    <meta name="description" content="ØªØ·Ø¨ÙŠÙ‚ Ø¥Ø³Ù„Ø§Ù…ÙŠ Ø´Ø§Ù…Ù„ - Ø§Ù„Ù…ØµØ­Ù Ø§Ù„Ø´Ø±ÙŠÙØŒ Ø£ÙˆÙ‚Ø§Øª Ø§Ù„ØµÙ„Ø§Ø©ØŒ Ø§Ù„Ø£Ø°Ø§Ù†">
    <meta name="author" content="Your Name">
    
    <title>ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* ========================================
           Ø§Ù„Ø«ÙŠÙ…Ø§Øª
        ======================================== */
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #111118;
            --card-bg: #1a1a22;
            --border-color: #2a2a35;
            --golden: #d4af37;
            --golden-light: rgba(212, 175, 55, 0.15);
            --golden-glow: rgba(212, 175, 55, 0.4);
            --text-primary: #ffffff;
            --text-secondary: #cccccc;
            --text-muted: #888888;
            --red: #e74c3c;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Amiri', serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* ========================================
           Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ
        ======================================== */
        .header {
            background: var(--bg-secondary);
            border-bottom: 2px solid var(--golden);
            padding: 15px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .back-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--golden);
            text-decoration: none;
            padding: 8px 15px;
            border-radius: 10px;
            background: var(--golden-light);
            font-size: 1rem;
        }

        .page-title {
            color: var(--golden);
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .settings-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--golden-light);
            color: var(--golden);
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            font-size: 1.2rem;
        }

        /* ========================================
           Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
        ======================================== */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
        }

        /* ========================================
           Ø§Ù„Ø¨ÙˆØµÙ„Ø©
        ======================================== */
        .compass-wrapper {
            position: relative;
            width: min(85vw, 340px);
            height: min(85vw, 340px);
        }

        /* Ø§Ù„Ù‚Ø±Øµ Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ - ÙŠØ¯ÙˆØ± Ù…Ø¹ Ø§Ù„Ø¬Ù‡Ø§Ø² */
        .compass-dial {
            position: absolute;
            inset: 0;
            border-radius: 50%;
            background: var(--card-bg);
            border: 5px solid var(--golden);
            box-shadow: 
                0 0 0 10px var(--bg-secondary),
                0 0 40px rgba(0, 0, 0, 0.5),
                0 0 80px var(--golden-glow),
                inset 0 0 50px rgba(0, 0, 0, 0.4);
            transition: transform 0.1s ease-out;
            will-change: transform;
        }

        /* Ø§Ù„Ø¯Ø±Ø¬Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ø±Øµ */
        .degree-label {
            position: absolute;
            font-size: clamp(12px, 3.5vw, 16px);
            font-weight: bold;
            color: var(--text-primary);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8);
        }

        /* Ø§Ù„Ø§ØªØ¬Ø§Ù‡Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .direction-n { color: var(--red); font-size: clamp(16px, 5vw, 22px); }
        .direction-e, .direction-w, .direction-s { color: var(--text-muted); }

        /* Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„Ø¯Ø±Ø¬Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
        .tick-mark {
            position: absolute;
            left: 50%;
            top: 8px;
            width: 2px;
            background: var(--text-muted);
            transform-origin: center calc(min(42.5vw, 170px) - 8px);
        }

        .tick-mark.major {
            height: 15px;
            width: 3px;
            background: var(--golden);
        }

        .tick-mark.minor {
            height: 8px;
            background: var(--border-color);
        }

        /* ========================================
           Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„ÙƒØ¹Ø¨Ø© - Ø«Ø§Ø¨ØªØ© Ø¹Ù†Ø¯ 93 Ø¯Ø±Ø¬Ø©
        ======================================== */
        .kaaba-marker {
            position: absolute;
            width: 55px;
            height: 55px;
            /* ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¹Ù†Ø¯ 93 Ø¯Ø±Ø¬Ø© Ù…Ù† Ø§Ù„Ù…Ø±ÙƒØ² */
            top: 50%;
            left: 50%;
            transform: rotate(93deg) translateY(-105px) rotate(-93deg);
            z-index: 10;
            filter: drop-shadow(0 0 15px var(--golden));
        }

        .kaaba-box {
            width: 100%;
            height: 100%;
            background: linear-gradient(145deg, #2a1a3a, #0f0515);
            border-radius: 8px;
            position: relative;
            border: 3px solid var(--golden);
            box-shadow: 
                0 0 20px var(--golden-glow),
                inset 0 0 15px rgba(0, 0, 0, 0.6);
        }

        .kaaba-band {
            position: absolute;
            top: 28%;
            left: 0;
            right: 0;
            height: 20%;
            background: linear-gradient(to right, var(--golden), #ffd700, var(--golden));
        }

        .kaaba-door {
            position: absolute;
            bottom: 8%;
            left: 50%;
            transform: translateX(-50%);
            width: 32%;
            height: 40%;
            background: linear-gradient(to bottom, #ffd700, var(--golden));
            border-radius: 4px 4px 0 0;
        }

        /* Ø¹Ù„Ø§Ù…Ø© 93Â° Ø¨Ø¬Ø§Ù†Ø¨ Ø§Ù„ÙƒØ¹Ø¨Ø© */
        .qibla-degree-label {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--golden);
            color: var(--bg-primary);
            padding: 3px 10px;
            border-radius: 10px;
            font-size: 0.75rem;
            font-weight: bold;
            white-space: nowrap;
        }

        /* ========================================
           Ù…Ø¤Ø´Ø± Ø§Ù„Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ø«Ø§Ø¨Øª (Ù„Ù„Ø£Ø¹Ù„Ù‰)
        ======================================== */
        .direction-pointer {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 20;
        }

        .pointer-arrow {
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 25px solid var(--golden);
            filter: drop-shadow(0 3px 5px rgba(0, 0, 0, 0.5));
        }

        /* Ø§Ù„Ù†Ù‚Ø·Ø© Ø§Ù„Ù…Ø±ÙƒØ²ÙŠØ© */
        .center-dot {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 18px;
            height: 18px;
            background: var(--golden);
            border-radius: 50%;
            border: 4px solid var(--card-bg);
            box-shadow: 0 0 15px var(--golden);
            z-index: 15;
        }

        /* ========================================
           Ø¹Ø±Ø¶ Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
        ======================================== */
        .current-heading {
            margin-top: 30px;
            text-align: center;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 20px 40px;
        }

        .heading-value {
            font-size: 3rem;
            font-weight: bold;
            color: var(--golden);
            display: flex;
            align-items: baseline;
            justify-content: center;
            gap: 5px;
        }

        .heading-value span {
            font-size: 1.5rem;
        }

        .heading-label {
            color: var(--text-muted);
            font-size: 1rem;
            margin-top: 5px;
        }

        .qibla-hint {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px dashed var(--border-color);
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .qibla-hint strong {
            color: var(--golden);
        }

        /* ========================================
           Ù…Ø¤Ø´Ø± Ø§Ù„ØªÙˆØ¬Ù‡ Ø§Ù„ØµØ­ÙŠØ­
        ======================================== */
        .alignment-alert {
            position: fixed;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: #27ae60;
            color: white;
            padding: 12px 25px;
            border-radius: 30px;
            font-size: 1rem;
            font-weight: bold;
            box-shadow: 0 5px 25px rgba(39, 174, 96, 0.5);
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 100;
        }

        .alignment-alert.show {
            opacity: 1;
        }

        /* ========================================
           Ø²Ø± Ø§Ù„ØªÙØ¹ÙŠÙ„ (iOS)
        ======================================== */
        .enable-btn {
            margin-top: 20px;
            padding: 15px 35px;
            background: var(--golden);
            border: none;
            border-radius: 30px;
            color: var(--bg-primary);
            font-family: inherit;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            display: none;
            box-shadow: 0 5px 25px var(--golden-glow);
        }

        .enable-btn.show {
            display: block;
        }

        /* ========================================
           Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª
        ======================================== */
        .instructions {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            padding: 15px 20px;
            padding-bottom: calc(15px + env(safe-area-inset-bottom, 0));
            text-align: center;
        }

        .instructions p {
            color: var(--text-muted);
            font-size: 0.9rem;
            margin: 0;
        }

        .instructions strong {
            color: var(--golden);
        }

        /* ========================================
           Responsive
        ======================================== */
        @media (max-height: 700px) {
            .compass-wrapper {
                width: min(70vw, 280px);
                height: min(70vw, 280px);
            }
            
            .kaaba-marker {
                width: 45px;
                height: 45px;
                transform: rotate(93deg) translateY(-85px) rotate(-93deg);
            }
            
            .current-heading {
                padding: 15px 30px;
                margin-top: 20px;
            }
            
            .heading-value {
                font-size: 2.5rem;
            }
        }
    </style>
</head>
<body>

    <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ -->
    <header class="header">
        <a href="settings.html" class="back-btn">
            <span>â€º</span>
            <span>Ø±Ø¬ÙˆØ¹</span>
        </a>
        <h1 class="page-title">
            <span>ğŸ§­</span>
            <span>Ø¨ÙˆØµÙ„Ø© Ø§Ù„Ù‚Ø¨Ù„Ø©</span>
        </h1>
        <a href="settings.html" class="settings-btn">âš™ï¸</a>
    </header>

    <!-- Ù…Ø¤Ø´Ø± Ø§Ù„ØªÙˆØ¬Ù‡ -->
    <div class="alignment-alert" id="alignmentAlert">
        âœ“ Ø£Ù†Øª ØªÙˆØ§Ø¬Ù‡ Ø§Ù„Ù‚Ø¨Ù„Ø©!
    </div>

    <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ -->
    <main class="main-content">
        
        <!-- Ø§Ù„Ø¨ÙˆØµÙ„Ø© -->
        <div class="compass-wrapper">
            
            <!-- Ù…Ø¤Ø´Ø± Ø§Ù„Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ø«Ø§Ø¨Øª -->
            <div class="direction-pointer">
                <div class="pointer-arrow"></div>
            </div>
            
            <!-- Ø§Ù„Ù‚Ø±Øµ Ø§Ù„Ø¯ÙˆØ§Ø± -->
            <div class="compass-dial" id="compassDial">
                
                <!-- Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„Ø¯Ø±Ø¬Ø§Øª -->
                <div id="tickMarks"></div>
                
                <!-- Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¯Ø±Ø¬Ø§Øª -->
                <div class="degree-label direction-n" style="top: 12%; left: 50%; transform: translateX(-50%);">0</div>
                <div class="degree-label" style="top: 18%; right: 18%; transform: translate(50%, -50%);">30</div>
                <div class="degree-label" style="top: 32%; right: 8%;">60</div>
                <div class="degree-label direction-e" style="top: 50%; right: 10%; transform: translateY(-50%);">90</div>
                <div class="degree-label" style="bottom: 32%; right: 8%;">120</div>
                <div class="degree-label" style="bottom: 18%; right: 18%;">150</div>
                <div class="degree-label direction-s" style="bottom: 12%; left: 50%; transform: translateX(-50%);">180</div>
                <div class="degree-label" style="bottom: 18%; left: 18%;">210</div>
                <div class="degree-label" style="bottom: 32%; left: 8%;">240</div>
                <div class="degree-label direction-w" style="top: 50%; left: 10%; transform: translateY(-50%);">270</div>
                <div class="degree-label" style="top: 32%; left: 8%;">300</div>
                <div class="degree-label" style="top: 18%; left: 18%;">330</div>
                
                <!-- Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„ÙƒØ¹Ø¨Ø© Ø¹Ù†Ø¯ 93 Ø¯Ø±Ø¬Ø© -->
                <div class="kaaba-marker">
                    <div class="qibla-degree-label">93Â° Ø§Ù„Ù‚Ø¨Ù„Ø©</div>
                    <div class="kaaba-box">
                        <div class="kaaba-band"></div>
                        <div class="kaaba-door"></div>
                    </div>
                </div>
                
            </div>
            
            <!-- Ø§Ù„Ù†Ù‚Ø·Ø© Ø§Ù„Ù…Ø±ÙƒØ²ÙŠØ© -->
            <div class="center-dot"></div>
            
        </div>

        <!-- Ø¹Ø±Ø¶ Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© -->
        <div class="current-heading">
            <div class="heading-value">
                <span id="headingValue">0</span>
                <span>Â°</span>
            </div>
            <p class="heading-label">Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù‡Ø§ØªÙ Ù…Ù† Ø§Ù„Ø´Ù…Ø§Ù„</p>
            <p class="qibla-hint">
                ÙˆØ¬Ù‘Ù‡ Ø§Ù„Ù‡Ø§ØªÙ Ø­ØªÙ‰ ÙŠØµØ¨Ø­ Ø§Ù„Ø±Ù‚Ù… <strong>93Â°</strong> ğŸ•‹
            </p>
        </div>

        <!-- Ø²Ø± Ø§Ù„ØªÙØ¹ÙŠÙ„ -->
        <button class="enable-btn" id="enableBtn" onclick="enableCompass()">
            ğŸ§­ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¨ÙˆØµÙ„Ø©
        </button>

    </main>

    <!-- Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª -->
    <div class="instructions">
        <p>
            Ø£Ù…Ø³Ùƒ Ø§Ù„Ù‡Ø§ØªÙ <strong>Ø£ÙÙ‚ÙŠØ§Ù‹</strong> ÙˆØ£Ø¯Ø±Ù‡ Ø­ØªÙ‰ ØªØµÙ„ Ø§Ù„ÙƒØ¹Ø¨Ø© ğŸ•‹ Ø¥Ù„Ù‰ <strong>Ø§Ù„Ù…Ø¤Ø´Ø± Ø§Ù„Ø¹Ù„ÙˆÙŠ</strong>
        </p>
    </div>

    <script>
        // ========================================
        // Ø§Ù„Ø¹Ù†Ø§ØµØ±
        // ========================================
        const compassDial = document.getElementById('compassDial');
        const headingValue = document.getElementById('headingValue');
        const alignmentAlert = document.getElementById('alignmentAlert');
        const enableBtn = document.getElementById('enableBtn');
        
        const QIBLA_DEGREE = 93; // Ø²Ø§ÙˆÙŠØ© Ø§Ù„Ù‚Ø¨Ù„Ø©

        // ========================================
        // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„Ø¯Ø±Ø¬Ø§Øª
        // ========================================
        function createTickMarks() {
            const container = document.getElementById('tickMarks');
            
            for (let i = 0; i < 72; i++) {
                const tick = document.createElement('div');
                tick.className = 'tick-mark ' + (i % 6 === 0 ? 'major' : 'minor');
                tick.style.transform = `translateX(-50%) rotate(${i * 5}deg)`;
                container.appendChild(tick);
            }
        }

        // ========================================
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙˆØµÙ„Ø©
        // ========================================
        let currentHeading = 0;
        let targetHeading = 0;
        
        function updateCompass(heading) {
            targetHeading = heading;
        }
        
        // ØªØ­Ø±ÙŠÙƒ Ø³Ù„Ø³
        function animateCompass() {
            // Ø­Ø³Ø§Ø¨ Ø£Ù‚ØµØ± Ù…Ø³Ø§ÙØ© Ù„Ù„Ø¯ÙˆØ±Ø§Ù†
            let diff = targetHeading - currentHeading;
            
            if (diff > 180) diff -= 360;
            if (diff < -180) diff += 360;
            
            currentHeading += diff * 0.15;
            
            if (currentHeading > 360) currentHeading -= 360;
            if (currentHeading < 0) currentHeading += 360;
            
            // ØªØ¯ÙˆÙŠØ± Ø§Ù„Ù‚Ø±Øµ (Ø¹ÙƒØ³ Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù‡Ø§ØªÙ)
            compassDial.style.transform = `rotate(${-currentHeading}deg)`;
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ø¯Ø±Ø¬Ø©
            headingValue.textContent = Math.round(currentHeading);
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙˆØ¬Ù‡ Ù„Ù„Ù‚Ø¨Ù„Ø© (Â±10 Ø¯Ø±Ø¬Ø§Øª)
            const qiblaDiff = Math.abs(currentHeading - QIBLA_DEGREE);
            const isAligned = qiblaDiff <= 10 || qiblaDiff >= 350;
            
            if (isAligned) {
                alignmentAlert.classList.add('show');
                // Ø§Ù‡ØªØ²Ø§Ø² Ø®ÙÙŠÙ
                if (qiblaDiff <= 3 && navigator.vibrate) {
                    navigator.vibrate(30);
                }
            } else {
                alignmentAlert.classList.remove('show');
            }
            
            requestAnimationFrame(animateCompass);
        }

        // ========================================
        // Ø§Ù„Ø¨ÙˆØµÙ„Ø© (DeviceOrientation)
        // ========================================
        function handleOrientation(event) {
            let heading;
            
            // iOS
            if (event.webkitCompassHeading !== undefined) {
                heading = event.webkitCompassHeading;
            }
            // Android
            else if (event.alpha !== null) {
                heading = (360 - event.alpha) % 360;
            }
            else {
                return;
            }
            
            updateCompass(heading);
        }

        // ========================================
        // ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¨ÙˆØµÙ„Ø© (iOS)
        // ========================================
        function enableCompass() {
            if (typeof DeviceOrientationEvent.requestPermission === 'function') {
                DeviceOrientationEvent.requestPermission()
                    .then(response => {
                        if (response === 'granted') {
                            window.addEventListener('deviceorientation', handleOrientation, true);
                            enableBtn.classList.remove('show');
                        }
                    })
                    .catch(console.error);
            }
        }

        // ========================================
        // Ø§Ù„ØªÙ‡ÙŠØ¦Ø©
        // ========================================
        function init() {
            createTickMarks();
            animateCompass();
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† iOS
            if (typeof DeviceOrientationEvent.requestPermission === 'function') {
                enableBtn.classList.add('show');
            } else {
                window.addEventListener('deviceorientation', handleOrientation, true);
            }
        }

        // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„
        document.addEventListener('DOMContentLoaded', init);
    </script>

</body>
</html>